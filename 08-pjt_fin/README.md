## Django에서 알고리즘 구현 및 성능 측정

## 임.남.기.

## CSV데이터 변환

✨1. Pandas의 `pd.read_csv`메서드를 이용하여 CVS파일을 읽어왔다.

error : 한국어를 인코딩하지 못해서, 화면에는 특수문자만 보였다.

solution : 메서드의 매개변수 `encoding='euc-kr'` 를 이용하여 해결

✨2. 화면에서 확인하기 위해 적절한 html을 생성형ai 도움받아서 작성

process : url에 app_name , name 설정하고 실행하여 반환되는 data의 형태 확인

✨3. JsonResponse 형태로 POSTMAN에서 확인 완료

✨4. 결측치를 제거

error : 결측치가 한두개가 아님

solution : 각각의 columns 옵션 마다 결측치를 따로 처리  
`컬럼.fillna( 바꿀값 , inplace=True)`메서드를 이용하여 해결

✨5. '나이' 결측치 제거 문제

question : '나이'의 결측치를 문자열인 'Null'로 변경해도 되는건가?

answer : 지금의 pjt에서는 모델을 설정하지 않았기 때문에 문제가 되지 않지만,  
추후에 '나이'의 필드를 `IntegerField` 또는 `FloatField`로 설정하게 된다면 오류가 발생할 것 이다.  
때문에 `'Null'` 대신 `None` 혹은 `NaN`으로 변경함이 적절해 보인다.

✨6. 나이 평균값 계산
`ave_age = data['나이'].mean()`를 이용한다. 

question : 결측치 제외한 평균계산

answer : `skipna=True`를 이용한다. 

✨7. 평균치 기준 가장 비슷한 10개 행을 반환

idea! : 
+ 평균으로부터 차이값 = abs(나이 - 평균치) 를 각 행에 대하여 계산
+ 차이값을 새로운 column으로 등록
+ 차이값 순으로 정렬
+ 상위 10개 반환

해결.

```
data['dif_age'] = abs(data['나이']- ave_age)

sorted_data = data.sort_values(by='dif_age').head(10)
```

## Loucst로 알고리즘 성능 측정

### 기본설정
> 3개의 알고리즘을 비교한다. `jywon_avg` `sooyeun_avg` 그리고 나의 알고리즘.
> 작업 간 대기 시간 : `wait_time = between(1, 3)` 
> 요청 수 10000명 까지 진행

### 가상유저수와 동시접속자 수에 따른 알고리즘 비교

✨1. 가상유저수 10000 , 동시접속자수 10
![alt text](ave_10000_10_.png)

> 평균응답시간 :  jywon 알고리즘에 비해 나의 알고리즘이 30% 더 느리다
> 최소응답시간 : 다른 두 알고리즘에 비해 2배 더걸린다.
> 평균응답크기 : 다른 두 알고리즘에 비해 2.5배 더 큰 데이터를 요구한다.

결론 : 매우 비효율적인 알고리즘을 만들었다.


---

✨2. 가상유저수 1000 , 동시 접속자수 10
![alt text](ave_1000_10_.png)
> 위 내용과 유사한 결과를 확인할 수 있다.

---

✨3. 가상유저수 10000 , 동시접속자수 1000
> 나의 알고리즘만 테스트

![alt text](ave_mine_01.png)

> 높은 실패율을 통해 동시 접속자 수가 증가하면서 시스템이 요청을 모두 처리할 수 없는 상황이 발생했음을 확인했다.
> 95th Percentile의 변화를 통해 응답시간이 지속적으로 급격히 증가했음을 알 수 있다. 
> 이후 부하가 줄어든 후에는 RPS와 응답시간이 점차 안정화 되는 모습을 확인 할 수 있다.

